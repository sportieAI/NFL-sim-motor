# Staging Environment Configuration
# DO NOT COMMIT SECRETS - Use environment variables

environment: staging

# Application Settings
app:
  name: "NFL-sim-motor"
  version: "1.0.0"
  debug: true
  log_level: "DEBUG"

# Randomness and Testing
simulation:
  random_seed: 42
  deterministic_mode: true
  error_injection_enabled: true
  max_simulation_time: 3600  # 1 hour timeout

# Logging Configuration
logging:
  level: "DEBUG"
  format: "json"
  correlation_ids_enabled: true
  output_file: "/var/log/nfl-sim-motor/staging.log"
  max_file_size_mb: 100
  backup_count: 5

# Database Configuration
database:
  postgres:
    host: "${POSTGRES_HOST:-localhost}"
    port: "${POSTGRES_PORT:-5432}"
    database: "${POSTGRES_DB:-nfl_sim_staging}"
    username: "${POSTGRES_USER:-staging_user}"
    password: "${POSTGRES_PASSWORD}"  # Must be set via environment
    pool_size: 10
    max_overflow: 20
    echo_sql: true
  
  redis:
    host: "${REDIS_HOST:-localhost}"
    port: "${REDIS_PORT:-6379}"
    db: "${REDIS_DB:-1}"
    password: "${REDIS_PASSWORD}"
    max_connections: 20

# Storage Configuration
storage:
  s3:
    bucket: "${S3_BUCKET:-nfl-sim-staging}"
    region: "${AWS_REGION:-us-west-2}"
    access_key: "${AWS_ACCESS_KEY_ID}"
    secret_key: "${AWS_SECRET_ACCESS_KEY}"
    endpoint_url: "${S3_ENDPOINT_URL}"  # For MinIO/local testing

# API Configuration
api:
  host: "0.0.0.0"
  port: 8000
  cors_enabled: true
  cors_origins: ["http://localhost:3000", "https://staging.example.com"]
  rate_limiting:
    enabled: true
    requests_per_minute: 120
    burst_size: 20

# Security
security:
  jwt_secret: "${JWT_SECRET}"  # Must be set via environment
  api_key_required: true
  signed_requests_required: false  # Disabled for staging
  admin_ip_allowlist: ["127.0.0.1", "10.0.0.0/8"]

# Monitoring & Observability
monitoring:
  metrics_enabled: true
  tracing_enabled: true
  health_check_interval: 30
  alerts_enabled: false
  prometheus_port: 9090

# Message Queue
messaging:
  broker_url: "${REDIS_URL:-redis://localhost:6379/2}"
  retry_policy:
    max_retries: 3
    backoff_multiplier: 2
    max_backoff_seconds: 60
  dead_letter_queue_enabled: true

# Testing
testing:
  property_tests_enabled: true
  fuzz_tests_enabled: true
  integration_tests_enabled: true
  performance_tests_enabled: false
